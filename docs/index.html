<head>
    <title>Artem Shchennikov</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style> body { margin: 0; } </style>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&display=swap" rel="stylesheet">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@700&display=swap" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
</head>
<body>

    <div id="mainContent">
        <div id="menu">

            <div id="menuFix">
                <ul>
                    <li id="li0" class="mli intText textBig bl">Bio</li>
                    <li id="li1" class="mli intText textSmall bl">Interactive graphics</li>
                    <li id="li2" class="mli intText textSmall bl">New age</li>
                    <li id="li3" class="mli intText textSmall bl">The days of past</li>
                    <li id="li4" class="mli intText textSmall bl">Links & Contacts</li>
                </ul>
            </div>

            <div id="infoFix">
            </div>

        </div>

        <div id="content">

            <div  id="li0div" class="lidiv">
                <h1 class="bl">Artem Shchennikov</h1>
                <dif id="bio">
                    <span class="textSmall">
                        data journalist / developer / designer of infographics
                    </span>
                </dif>
            </div>

            <div id="li1div" class="lidiv">
                <div class="subHeader">
                    <span class="textSmall">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    </span>
                </div>
                <div id="li1divCntnt">
                </div>
            </div>

            <div id="li2div" class="lidiv">
                <div class="subHeader">
                    <span class="textSmall">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    </span>
                </div>
                <div id="li2divCntnt" class="col4">
                </div>
            </div>

            <div id="li3div" class="lidiv">
                <div class="subHeader">
                    <span class="textSmall">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                    </span>
                </div>
                <div id="li3divCntnt" class="col4">

                </div>
            </div>

            <div id="li4div" class="lidiv">
                <div class="subHeader">
                    <span class="textSmall">
                        You can check out most of my work at the links below. And contact me if you like it.
                    </span>
                </div>
            </div>

        </div>
    </div>

    <script>

        var test = true;

        $(document).on(
            "click", ".mli",  function() {

                test = false;

                $( ".mli" ).removeClass("textBig").addClass("textSmall");
                $( this ).removeClass("textSmall").addClass("textBig");

                disaredElement = $( `#${$( this ).attr("id")}div` )

                $('html, body').stop().animate({
                    scrollTop: disaredElement.offset().top
                }, 250);

                setTimeout(
                    function() {
                        test = true;
                    },
                    250
                );

            }
        );

        var lastId,
        scrollItems = $( ".lidiv" ).map(
            function() {
                return $(this).attr("id");
            }
        );

        $(window).scroll(function(){

            var fromTop = $(this).scrollTop() + $( "#menu" ).height()/2;
            
            var cur = scrollItems.map(function(){
                if ($(`#${this}`).offset().top < fromTop)
                return this;
            });
            
            id = cur[cur.length-1];
            
            if (lastId !== id) {
                lastId = id;

                if (test) {
                    $( ".mli" ).removeClass("textBig").addClass("textSmall");
                    $( `#${id.replace("div", "")}` ).removeClass("textSmall").addClass("textBig");
                };
            }                   
        });

        // Finish page

        function fixW() {
            var w = $("#menu").width();
            $( "#menuFix" ).css({"width": `${ w }px`});
            $( "#infoFix" ).css({"width": `${ w }px`});
        };

        fixW();

        var data = {};

        function loadPics(path, dest, cols, isInter, suf) {
            $.getJSON(path, function(json) {

                var contentW = $("#content").width(),
                    sqW;

                if (cols == 4) {
                    sqW = (contentW - contentW * 0.0025 * 3) / 4;
                } else {
                    sqW = (contentW - contentW * 0.0025) / 2;
                }

                $.each( json, function( i, val ) {

                    ind = `g${i}${suf}`

                    cntnr = $( "<div>", {
                        "id": `${ind}cntnr`,
                        "class": `${val.mode} pikpook`,
                        "height": `${sqW}px` 
                    }).appendTo( `#${dest}` );

                    showCntnr = $( "<div>", {
                        "id": `${ind}showCntnr`,
                        "class": "showCntnr",
                    }).appendTo( cntnr );

                    $( "<img>", {
                        "src": val.pic,
                        "height": "100%",
                        "width": "100%"
                    }).appendTo( showCntnr );

                    if (isInter) {
                        
                        $( "<div>", {
                            "id": ind,
                            "class": "show textBig wh intTextWh",
                            "hidden": "true",
                            html: "Activate"
                        }).appendTo( showCntnr );
                    }

                    data[ind] = {
                        "link": val.link,
                        "text": val.text
                    };

                });

            });
        }

        loadPics("./new_content.json", "li3divCntnt", 4, false, "O");
        loadPics("./new_content.json", "li2divCntnt", 4, false, "N");
        loadPics("./interactive_content.json", "li1divCntnt", 2, true, "I");

        $(document).on(
            "mouseover", ".intText", function() {
                $( this ).removeClass("bl").addClass("red");
            }
        );
        $(document).on(
            "mouseleave", ".intText", function() {
                $( this ).removeClass("red").addClass("bl");
            }
        );

        $(document).on(
            "mouseover", ".intTextWh", function() {
                $( this ).removeClass("wh").addClass("red");
            }
        );
        $(document).on(
            "mouseleave", ".intTextWh", function() {
                $( this ).removeClass("red").addClass("wh");
            }
        );

        $(document).on(
            "mouseover", ".square, .rect", function() {
                $(`#${$( this ).attr("id").replace("cntnr", "")}`).removeAttr("hidden");
            }
        );
        $(document).on(
            "mouseleave", ".square, .rect", function() {
                $(`#${$( this ).attr("id").replace("cntnr", "")}`).attr("hidden", "ture");
            }
        );

        $(document).on(
            "mouseover", ".pikpook", function() {

                ind = `${$( this ).attr("id").replace("cntnr", "")}`

                // console.log(ind);

                var infoDiv = $("<div>", {
                    "id": "info",
                    "class": "info"
                }).appendTo( $( "#infoFix" ) );

                $( "<span>", {
                    "class": "textSmall",
                    html: "About:<br>"
                }).appendTo( infoDiv );

                $( "<span>", {
                    "class": "textSmaller",
                    // html: "text"
                    html: data[ind]["text"]
                }).appendTo( infoDiv );

            }
        );
        $(document).on(
            "mouseout", ".pikpook", function() {

                // ind = `${$( this ).attr("id").replace("cntnr", "")}`

                $( `#info` ).remove();
            }
        );
        

        $(document).on(
            "click", ".show", function() {

                let curId = $( this ).attr("id");

                $( `#${curId}showCntnr` ).attr("hidden", "true");

                $( "<iframe>", {
                    "id": `${curId}intrctv`,
                    "height": "100%",
                    "width": "100%",
                    "class": "interGr",
                    "src": data[curId]["link"],
                    "frameborder": 0

                }).appendTo( $( `#${curId}cntnr` ) );

                $( "<span>", {
                    "id": `${curId}close`,
                    "class": "x textBig wh intTextWh",

                    html: "âœ•"

                }).appendTo( 
                    
                    $( "<div>", {
                        "class": "close"
                    }).appendTo( $( `#${curId}cntnr` ) )
                );
            }
        );

        $(document).on(
            "click", ".x",  function() {

                let curId = $( this ).attr("id");

                $( `#info` ).remove();

                $( `#${curId.replace("close", "showCntnr")}` ).removeAttr("hidden");
                $( `#${curId.replace("close", "intrctv")}` ).remove();
                $( this ).remove();
                
            }
        );

    </script>
    
</body>